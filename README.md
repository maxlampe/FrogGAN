
# FrogGAN

Created and maintained by [Max Lamparth](https://github.com/maxlampe)

## Abstract

Art can be understood by everyone and transcends boundaries in society. 
Sometimes art can become a part of your every-day life and seeing a couple of drawn, cute frogs on Reddit related to 
current events every Wednesday kinda makes you happy. Sometimes, you realize that you cannot draw yourself, 
but would still like to create content like it...

To this end, I implemented _deep convolutional generative adversarial networks_ (DCGANs) in _PyTorch_ 
to create images of drawn frogs in the style of the Austrian artist 
[ManBroDude](https://manbrodude.art/) aka [smalllebowsky](https://www.reddit.com/user/SmallLebowsky/) on _Reddit_.

The target dataset was of small size (< 500 images with large variety) and to compensate, I pre-trained the networks on 
a larger dataset of japanese style comic faces (about 110k images) using transfer learning before adjusting all layers 
during fine-tuning. From multiple tried training adjustments, label smoothing yielded the best results. For 
hyper parameter optimization, _Frechet-Inception-Distance_ (FID) was used as objective value.
Experimental data augmentations (segmentation of object with and without background) together with regular data 
augmentations (randomized crops, flips, rotations, shearing, brightness and contrast fluctuations) have been applied.

The target dataset was generated by myself using screen cropping tools and Adobe Photoshop. Due to copyright reasons,
the dataset cannot be shared.
For the pre-training, I used the _anime faces_ dataset from Jie Lei's [animeGAN](https://github.com/jayleicn/animeGAN)
project.

The project is completed for the time being, as I am waiting for more content to be created by the artist to re-try it
in the future with a larger dataset to obtain better results.

## Results

Here are a few of my favourite creations:

![image](images/frognet_ok1.png)

These and the ones (including the nightmare sample) shown below were selected from about 400 generated images.
Most of them are of lesser quality. The DCGAN output resembles the original art, however, it fails to achieve 
convincing results. _Creativity_ and inference from the network are there, however, signs of over-fitting, i.e. plainly
reproducing parts of the original dataset, are present as well. 

Personally, I am not satisfied with the results, but I am looking forward to trying it again with a larger dataset in a
couple of months. After struggling to train the GAN initially, where I would have been happy with anything having 
frog-like eyes, I am content. 
I like how it sometimes mixes vertical and horizontal pupils to create some sort of heterochromia in
the frogs. 
I also like "Emmanuel" (above image, last row, second from the left).

![image](images/frognet_ok2.png)

Here are a few results that resemble contents from a frog-ish nightmare rather than the original art (hand-picked). 
These are far more representative of the final GAN output than the selected 30 images above:

![image](images/frognet_night1.png)

Sample output (raw without cherry-picking) of the DCGAN after 50 epochs on the anime faces dataset before training
on the frog dataset. The difference in quality highlights the importance of a large dataset, or rather how that can 
simplify the process. The pre-training and therefore the output below was done without any further efforts. 
The quality could have been definitely improved, however, I did not think it would improve the final result and 
therefore did not attempt it in the first place.

![image](images/anime_gen.png)

For using GANs to create anime faces, I would recommend the above-mentioned 
[animeGAN](https://github.com/jayleicn/animeGAN) project.

## Article

- introduction / state goal (credit original artist)
- emphasize challenge (target dataset < 500 images with large variety)
  
### Hyper parameters

- state architecture used (future: 124 dim)
- Used techniques (DCGAN, pre-training, label smoothing, data augmentations, data pre-processing, FID, optimizer)
- Tried without success (D noise, loss threshold training schedule)
- used libraries / codes (pytorch, optuna, FID code, pytorch example)

### Datasets and Augmentations

- used datasets
- augmentation discussion (show data pre-processing chain and different datasets)

### Hyper parameter search

- hyper parameter chosen (optuna hp significance)

### Training

- show anime faces result and training parameters
- show frog training and results
- fid discussion

### Papers and Articles

- Show final result
- list of papers/articles
- link to reddit post

Reference
[This person does not exist](https://thispersondoesnotexist.com/)

## Usage

This project is very much WIP and changes are constantly being made. The project is running on Google Colab and at the moment, only back-end modules are uploaded here.

The project is almost complete and an in detail presentation of the results will follow soon.

A final, minimized jupyter notebook will be uploaded as well.

## License
[MIT](https://choosealicense.com/licenses/mit/)